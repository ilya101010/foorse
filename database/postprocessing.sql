UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Российская Федерация';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Республика Марий Эл';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Республика Башкортостан';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Курганская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Омская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Краснодарский край';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Ростовская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Тульская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Республика Калмыкия';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Кировская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Республика Мордовия';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Тамбовская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Республика Бурятия';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Нижегородская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Орловская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Владимирская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Республика Северная Осетия - Алания';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Республика Крым';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Липецкая область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Челябинская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'г.Москва';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Республика Ингушетия';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Забайкальский край';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Иркутская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Карачаево-Черкесская Республика';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Самарская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Приморский край';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Пермский край';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Свердловская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Ставропольский край';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Пензенская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Саратовская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Белгородская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Республика Дагестан';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Алтайский край';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Удмуртская Республика';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Тверская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Брянская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Республика Саха (Якутия)';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Красноярский край';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Оренбургская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Ярославская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Воронежская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Кемеровская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Курская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Чувашская Республика';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Псковская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Новосибирская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Ивановская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Республика Тыва';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Калужская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Волгоградская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'г.Санкт-Петербург';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Смоленская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Камчатский край';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Рязанская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Калининградская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Тюменская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Чеченская Республика';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Республика Татарстан';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'г.Севастополь';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Архангельская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Мурманская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Томская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Московская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Астраханская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Республика Алтай';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Республика Адыгея';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Ямало-Ненецкий автономный округ';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Магаданская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Амурская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Новгородская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Республика Коми';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Республика Карелия';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Костромская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Ленинградская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Ульяновская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Хабаровский край';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Еврейская автономная область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Вологодская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Чукотский автономный округ';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Республика Хакасия';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Ханты-Мансийский автономный округ';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Сахалинская область';
UPDATE tags SET tag_type = 'region' WHERE tag_name = 'Кабардино-Балкарская Республика';

UPDATE tags
SET tag_type = 'title'
WHERE tag_id IN (
    SELECT table_title_tag_id
    FROM table_std
);

CREATE TABLE regions AS
	SELECT table_id, tag_name AS region, tags.tag_id FROM table_tags
	LEFT JOIN tags ON table_tags.tag_id = tags.tag_id
	WHERE tags.tag_type = 'region';

-- update with hands

CREATE TABLE taglists AS 
SELECT table_id, group_concat(tag_name, '; ') AS taglist FROM table_tags
	LEFT JOIN tags ON table_tags.tag_id = tags.tag_id
	WHERE tags.tag_type = 'filter'
	GROUP BY table_id;

SELECT * FROM data
INNER JOIN tables ON tables.table_id = data.table_id
WHERE tables.table_std_id = 1;

SELECT table_id, group_concat(tag_name, "; ") FROM table_tags
LEFT JOIN tags ON table_tags.tag_id = tags.tag_id
WHERE tags.tag_type = "filter"
GROUP BY table_id;

SELECT * FROM data
INNER JOIN tables ON tables.table_id = data.table_id
INNER JOIN taglists ON tables.table_id = taglists.table_id
WHERE tables.table_std_id = 1
LIMIT 100;



SELECT region, taglist as tags, indicator_name as indicator, subindicator_name as subindicator, value FROM data
	INNER JOIN tables ON tables.table_id = data.table_id
	INNER JOIN taglists ON tables.table_id = taglists.table_id
	INNER JOIN regions ON tables.table_id = regions.table_id
	INNER JOIN indicators on data.indicator_id = indicators.indicator_id
	INNER JOIN subindicators on data.subindicator_id = subindicators.subindicator_id
	WHERE tables.table_std_id = 7;

